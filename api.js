// Generated by CoffeeScript 2.2.1
angular.module('ngApi', ['ngLocalStorage']).provider('$api', [
  function() {
    return {
      baseUri: '',
      init: function(uri) {
        return this.baseUri = uri.replace(/(\/)*$/i,
  '');
      },
      $get: function() {
        return {
          baseUri: this.baseUri
        };
      }
    };
  }
]).factory('baseUri', [
  '$api',
  function($api) {
    return $api.baseUri;
  }
]).factory('token', [
  '$localStorage',
  function($db) {
    return $db.get('token');
  }
]).factory('beforeRequest', [
  'token',
  'baseUri',
  function(token,
  uri) {
    return {
      request: function(config) {
        if (token && config.url.indexOf(uri) === 0) {
          config.headers['Authorization'] = token;
        }
        return config;
      }
    };
  }
]).config([
  '$httpProvider',
  function($httpProvider) {
    $httpProvider.defaults.useXDomain = true;
    $httpProvider.interceptors.push('beforeRequest');
  }
]);
